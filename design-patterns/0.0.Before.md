# 设计模式

## 定义

* 某类特定问题的代码设计解决方案
* 是一套代码设计的经验总结

> 设计模式，其实只是前人针对某类问题的代码设计经验而已，并没有很高大上

## 作用

* 提高代码复用率，降低开发周期和成本
* 提高代码可维护性，可拓展性
* 使代码更加优雅
* 让代码更容易被他人理解

## 面向对象设计的基本原则

### 单一职责原则（Single Responsibility Principle）

> There should never be more than one reason for a class to change.

> 一个类，最好只负责一件事，只有一个引起它变化的原因。

如果一个类承担的职责过多，即耦合性太高 = 一个职责的变化可能会影响到其它的职责。

### 开放封闭原则（Open Closed Principle）

> Software entities (classes, modules, functions) should be open for extension but closed for modification。

> 一个实体（类，函数，模块等）应该对外扩展开放，对内修改封闭

1. 即每次发生变化时，要通过添加新的代码来增强现有类型的行为，而不是修改原有的代码。
2. 符合开放封闭原则的最好方式是提供一个固有的接口，然后让所有所有可能发生变化的类实现该接口，让固定的接口与相关对象进行交互。

### 里氏替换原则（Liskov Substitution principle）

> Functions that use pointers or references to base classes must be able to use objects of derived classes without knowing it.

子类必须替换掉他们的父类型。

1. 在软件开发的过程中，子类替换掉父类后，程序的行为是一样的。
2. 只有当子类替换掉父类后软件的功能不受影响时，父类才能真正地被复用，而子类也可以在父类的基础上添加新的行为。

### 依赖倒置原则（Dependency Inversion Principle）

> 1. High level modules should not depend upon low level modules. Both should depend upon abstractions.
> 2. Abstractions should not depend upon details. Details should depend upon abstraction.

> 1. 高层模块不应该依赖于低层模块，二者都应该依赖于抽象。
> 2. 抽象不应该依赖于具体实现细节，而具体实现细节应该依赖于抽象。

所谓的的 “面向接口编程，而不是面向实现编程”。这样可以降低客户与具体实现的耦合。

### 接口隔离原则（Interface Segregation Principle）

> Clients should not be forced to depend upon interfaces that they do not use.

> 客户类不应被强迫依赖那些它们不需要的接口

不要让一个单一的接口承担过多的职责，而应把每个职责分离到多个专门的接口中，进行接口分离。

### 合成/聚合复用原则(Composite/Aggregate Reuse Principle)

在一个新的对象里面使用一些已有的对象，使之成为新对象的一部分；新的对象通过向这些对象的委派达到复用这些对象的目的。

应首先使用合成/聚合，合成/聚合则使系统灵活，其次才考虑继承，达到复用的目的。而使用继承时，要严格遵循里氏代换原则。有效地使用继承会有助于对问题的理解，降低复杂度，而滥用继承会增加系统构建、维护时的难度及系统的复杂度。
如果两个类是“Has-a”关系应使用合成、聚合，如果是“Is-a”关系可使用继承。"Is-A"是严格的分类学意义上定义，意思是一个类是另一个类的"一种"。而"Has-A"则不同，它表示某一个角色具有某一项责任。

聚合表示整体和部分的关系，表示“拥有”。如奔驰S360汽车，对奔驰S360引擎、奔驰S360轮胎的关系是聚合关系，离开了奔驰S360汽车，引擎、轮胎就失去了存在的意义。在设计中, 聚合不应该频繁出现，这样会增大设计的耦合度。
合成则是一种更强的“拥有”，部分和整体的生命周期一样。合成的新的对象完全支配其组成部分，包括它们的创建和湮灭等。一个合成关系的成分对象是不能与另一个合成关系共享的。
换句话说，合成是值的聚合（Aggregation by Value），而一般说的聚合是引用的聚合（Aggregation by Reference）。

### 最少知识原则（迪米特法则）（Least Knowledge Principle）

> Each unit should have only limited knowledge about other units: only units "closely" related to the current unit.

一个模块或对象应尽量少的与其他实体之间发生相互作用，使得系统功能模块相对独立，这样当一个模块修改时，影响的模块就会越少，扩展起来更加容易。

1. 关于迪米特法则的其他描述：只与你直接的朋友们通信；不要跟“陌生人”说话。
2. 外观模式（Facade Pattern)和中介者模式（Mediator Pattern）就使用了迪米特法则。

## 参考

小话设计模式： https://zhuanlan.zhihu.com/p/24269134
最易懂的设计模式解析：https://www.jianshu.com/p/6e5eda3a51af
面向对象的设计原则总结：https://www.cnblogs.com/temptation/archive/2008/03/10/1098351.html